<Window x:Class="SSApp.UI.ManageUsersWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:data="clr-namespace:SSApp.Data.Models;assembly=SSApp.Data"
        Title="Manage Users"
        Height="450"
        Width="750"
        WindowStartupLocation="CenterOwner"
        WindowStyle="None"
        Background="#020617"
        KeyDown="Window_KeyDown">
	<Window.Resources>
		<SolidColorBrush x:Key="AccentBrush" Color="#2563EB"/>

		<Style x:Key="PrimaryButtonStyle" TargetType="Button">
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="Background" Value="{StaticResource AccentBrush}"/>
			<Setter Property="Padding" Value="8,4"/>
			<Setter Property="Margin" Value="0,0,8,0"/>
			<Setter Property="FontSize" Value="13"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="Cursor" Value="Hand"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="Button">
						<Border CornerRadius="6"
                                Background="{TemplateBinding Background}">
							<ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              Margin="6,1"/>
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Background" Value="#3B82F6"/>
							</Trigger>
							<Trigger Property="IsPressed" Value="True">
								<Setter Property="Background" Value="#1D4ED8"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<Style x:Key="DangerButtonStyle" BasedOn="{StaticResource PrimaryButtonStyle}" TargetType="Button">
			<Setter Property="Background" Value="#DC2626"/>
			<Style.Triggers>
				<Trigger Property="IsMouseOver" Value="True">
					<Setter Property="Background" Value="#EF4444"/>
				</Trigger>
				<Trigger Property="IsPressed" Value="True">
					<Setter Property="Background" Value="#B91C1C"/>
				</Trigger>
			</Style.Triggers>
		</Style>

		<Style x:Key="TitleBarButtonStyle" TargetType="Button">
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="Width" Value="40"/>
			<Setter Property="Height" Value="32"/>
			<Setter Property="Cursor" Value="Hand"/>
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="Button">
						<Border Background="{TemplateBinding Background}">
							<ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Background" Value="#111827"/>
							</Trigger>
							<Trigger Property="IsPressed" Value="True">
								<Setter Property="Background" Value="#1F2937"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<Style TargetType="DataGridColumnHeader">
			<Setter Property="Background" Value="#020617"/>
			<Setter Property="Foreground" Value="#E5E7EB"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
			<Setter Property="BorderBrush" Value="#111827"/>
			<Setter Property="BorderThickness" Value="0,0,0,1"/>
		</Style>
	</Window.Resources>

	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="32"/>
			<!-- title bar -->
			<RowDefinition Height="*"/>
			<!-- content -->
		</Grid.RowDefinitions>

		<!-- Custom title bar -->
		<Border Grid.Row="0"
                Background="#020617"
                BorderBrush="#2563EB"
                BorderThickness="0,0,0,1">
			<Grid MouseDown="TitleBar_MouseDown">
				<TextBlock Text="SSApp – Manage Users"
                           Foreground="White"
                           VerticalAlignment="Center"
                           Margin="12,0,0,0"
                           FontSize="13"
                           FontWeight="SemiBold"/>
				<StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Right">
					<Button Style="{StaticResource TitleBarButtonStyle}"
                            Content="✕"
                            Click="Close_Click"/>
				</StackPanel>
			</Grid>
		</Border>

		<!-- Content -->
		<Grid Grid.Row="1" Margin="12">
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto"/>
				<RowDefinition Height="*"/>
				<RowDefinition Height="Auto"/>
			</Grid.RowDefinitions>

			<TextBlock Grid.Row="0"
                       Text="Manage Users"
                       Foreground="White"
                       FontSize="20"
                       FontWeight="Bold"
                       Margin="4,0,0,8"/>

			<Border Grid.Row="1"
                    Background="#020617"
                    CornerRadius="10"
                    Padding="10">
				<DataGrid x:Name="UsersGrid"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          Background="#020617"
                          Foreground="White"
                          BorderBrush="#111827"
                          BorderThickness="0"
                          RowBackground="#020617"
                          AlternatingRowBackground="#111827"
                          GridLinesVisibility="None"
                          HorizontalGridLinesBrush="#111827"
                          VerticalGridLinesBrush="#111827"
                          PreviewKeyDown="UsersGrid_PreviewKeyDown">
					<DataGrid.Columns>
						<DataGridTextColumn Header="Id"
                                            Binding="{Binding Id}"
                                            IsReadOnly="True"
                                            Width="60" />
						<DataGridTextColumn Header="Username"
                                            Binding="{Binding Username}"
                                            Width="2*" />
						<DataGridTextColumn Header="Password"
                                            Binding="{Binding Password}"
                                            Width="3*" />
						<DataGridComboBoxColumn Header="Role"
                                                SelectedItemBinding="{Binding Role}"
                                                Width="*">
							<DataGridComboBoxColumn.ItemsSource>
								<x:Array Type="{x:Type data:UserRole}">
									<data:UserRole>Viewer</data:UserRole>
									<data:UserRole>Operator</data:UserRole>
									<data:UserRole>Admin</data:UserRole>
								</x:Array>
							</DataGridComboBoxColumn.ItemsSource>
						</DataGridComboBoxColumn>
					</DataGrid.Columns>
				</DataGrid>
			</Border>

			<StackPanel Grid.Row="2"
                        Orientation="Horizontal"
                        HorizontalAlignment="Right"
                        Margin="0,10,0,0">
				<Button Content="Add"
                        Width="80"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Click="Add_Click"/>
				<Button Content="Delete"
                        Width="80"
                        Style="{StaticResource DangerButtonStyle}"
                        Click="Delete_Click"/>
				<Button Content="Save"
                        Width="80"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Click="Save_Click"/>
				<Button Content="Close"
                        Width="80"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Click="Close_Click"/>
			</StackPanel>
		</Grid>
	</Grid>
</Window>
